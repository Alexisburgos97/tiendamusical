<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
 	  xmlns:p="http://primefaces.org/ui"
 	  xmlns:ui="http://java.sun.com/jsf/facelets">
      
      
      <h:head>
      	<ui:include src="/pages/commons/scripts.xhtml"></ui:include>
      	
      	<script src="https://www.paypal.com/sdk/js?client-id=AXmvGx4rtGU-vuWXWX5seAGsn8Kw7m-oNDPrCNkyqIhWrQBL9qyVfnLAPWRTjvBIshlqqhcTQBvEa4EL&amp;currency=MXN"></script>
		<script>paypal.Buttons({
		    		createOrder: function(data, actions) {
				          return fetch('../../PayPalServlet', {
				        	  method: 'post',
				        	  headers:{
				        		  'content-type': 'application/json'
				        	  }
				          }).then(function(response){
				        	  var json = response.json();
				        	  console.log("response: " + JSON.stringify(json));
				        	  return json;
				          }).then(function(data){
				        	  console.log("data: " + JSON.stringify(data));
				        	  return data.result.id;
				          })
				      },
				      onApprove: function(data,actions){
				    	  return actions.order.capture().then(function(detalle){
				    		  //generar la factura con la orden de compra.
				    		  finalizarTransaccion();
				    	  })
				      }
				    }).render('#divPayPalContainer');</script>
		
      </h:head>
      
      <h:body style="background-color: black">
      	<div class="ui-fluid">
      		<h:form id="formCarrito">
      			
      			<ui:include src="/pages/commons/navbar.xhtml"></ui:include>
      		
      			<div class="p-grid sample-layout">
      			
      			 	<ui:include src="/pages/commons/header.xhtml"></ui:include>
      			 	
      			 	<div class="p-col-12 p-md-10 p-col-nogutter">
      			 		<div class="p-grid">
      			 			<div class="p-col-12">
      			 			
      			 				<ui:include src="/pages/commons/steps.xhtml"></ui:include>
      			 			
      			 				<div class="p-col" style="width:90%; margin:0px auto; text-align:text-center;" >
			      			 		<div id="divPayPalContainer" class="p-col" style="width:100%; margin:0px auto;"  >
			      			 			<p:remoteCommand name="finalizarTransaccion" action="#{pagoController.guardarFactura}"></p:remoteCommand>
			      			 		</div>
			      			 	</div>
      			 				      			 				  
      			 			</div>
      			 		</div>
      			 	</div>
      			 	
					<ui:include src="/pages/commons/footer.xhtml"></ui:include>
      			 	
      			</div>
      		</h:form>
      	</div>
      </h:body>

</html>